{% extends "base.html" %}

{% block title %} Chat {% endblock %}

{% block body %}

<div id="root" class="">
</div>

// Ugh this is so broken, something about react and react-query versions...
// no query is actually running, and i think this whole new react 18 thing is causing it

<script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@tanstack/react-query@4.3.9/build/umd/index.production.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<script type="text/babel">
    const { QueryClient, QueryClientProvider, useQuery } = window.ReactQuery;
    const rootElement = document.getElementById('root');
    const queryClient = new QueryClient();

    const fetchHistory = async () => {
        // const res = await fetch(window.location.host + "/promptHistory");
        const res = await fetch("https://jsonplaceholder.typicode.com/users");
        return res.json();
    };

    class ShoppingList extends React.Component {
        render() {
            return (
                <div>
                    <h1>Stuff {this.props.name}</h1>
                    <ul>
                        <li>Wow</li>
                        <li>Wow2</li>
                        <li>Wo3</li>
                    </ul>
                </div>
            );
        }
    }
    function Todos() {
        console.log("hmm");
        const { isLoading, isError, data, error } = useQuery('history', async () => {
            console.log("Trying something...");
            // const res = await fetch(window.location.host + "/promptHistory");
            // const res = await fetch("https://jsonplaceholder.typicode.com/users");
            // return res.json();
            return ["hi"]
        });
        if (isLoading) return <div className="text-bold">Loading...</div>;
        if (isError) return 'Error: ' + error.message;
        return (
            <div>
                {data.map((item) => <div>{item}</div>)}
            </div>
        );
    }
    function App() {
        return (
            <QueryClientProvider client={queryClient}>
                <Todos />
            </QueryClientProvider>
        )
    }
    ReactDOM.render(
        <App />,
        rootElement
    )
</script>



{% endblock %}