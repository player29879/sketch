{% macro reference_card(sketchpad, sketchpadlink=False) -%}

<!-- Flexbox for card, full width, rounded with shadow -->
<div class="relative">
    <div class="absolute top-0 right-0 bg-slate-50 hover:bg-slate-300 dark:bg-gray-800 dark:hover:bg-gray-900 rounded-bl-lg rounded-tr-lg"
        onclick="testing(`{{ sketchpad.reference.to_pyscript() }}`)">
        <svg class="h-8" viewbox="0 0 360 442">
            <g fill="white" stroke="black" stroke-width="40">
                <rect x="20" y="20" rx="60" ry="60" width="200" height="282" />
                <rect x="140" y="140" rx="60" ry="60" width="200" height="282" />
            </g>
        </svg>
    </div>
    <div class="flex flex-row items-baseline shadow-lg justify-center bg-slate-50 dark:bg-slate-900">
        <div class="grow flex flex-col px-4 bg-no-repeat bg-[length:100px_20px]" style="background-image: url(  );">
            <div class="grow flex flex-col p-4">
                <div class="flex flex-row space-x-4 items-center">
                    <img class="h-8 shadow dark:bg-slate-300" src="{% if sketchpad.reference.type == 'SqliteColumn' %}
                            {{ url_for('static', path='SQLite370.svg') }}
                        {% elif sketchpad.reference.type == 'PandasDataframeColumn' %}
                        {{ url_for('static', path='pandas.svg') }}
                        {% elif sketchpad.reference.type == 'WikipediaTableColumn' %}
                        {{ url_for('static', path='Wikipedia-logo-v2-en.svg') }}
                        {% else %}{{ url_for('static', path='approximatelabs-logo.png') }}    {% endif %}" alt="Logo"
                        class="w-8 h-8">
                    {% if sketchpadlink %}
                    <a href="{{ url_for('sketchpad', sketchpad_id=sketchpad.id) }}"
                        class="text-sm font-semibold text-slate-500 dark:text-slate-300">
                        {{ sketchpad.id }}
                    </a>
                    {% else %}
                    <a class="text-l font-bold overflow-hidden w-24" href="
                    {{ url_for('reference', reference_id=sketchpad.reference.id) }}">
                        ref:{{ sketchpad.reference.id }}
                    </a>
                    {% endif %}
                </div>
                {% if sketchpad.reference.type == 'SqliteColumn' %}
                <div class="text-l font-bold">{{ sketchpad.reference.data['path'] }}</div>
                <div class="grow flex flex-row align-baseline">
                    <div class="flex flex-col">
                        <div class="text-sm font-bold">Query:</div>
                        <div class="text-xs font-bold">Column:</div>
                    </div>
                    <div class="p-2"></div>
                    <div class="flex flex-col">
                        <div class="text-sm font-semibold">{{ sketchpad.reference.data['query'] }}</div>
                        <div class="text-xs font-semibold">{{ sketchpad.reference.data['column'] }}</div>
                    </div>
                </div>
                {% elif sketchpad.reference.type == 'PandasDataframeColumn' %}
                <div class="text l font-bold">{{ sketchpad.reference.data['dfname'] }}</div>
                <div class="text l font-bold">{{ sketchpad.reference.data['col'] }}</div>
                {% elif sketchpad.reference.type == 'WikipediaTableColumn' %}
                <div class="text l font-bold">{{ sketchpad.reference.data['url'] }}</div>
                <div class="text l font-bold">{{ sketchpad.reference.data['column'] }}</div>
                {% else %}
                <div class="text l font-bold">Unknown</div>
                <div class="text l font-bold">Unknown</div>
                {% endif %}
            </div>

        </div>
        <div class="flex flex-col items-end px-4">
            <p class="text-xl">
                <span class="text-sm text-cyan-800">
                    Est #Uniques:
                </span>
                {{ sketchpad.get_sketchdata_by_name("HyperLogLog").count() | round | int }}
            </p>
            <p class="text-xl">
                <span class="text-sm text-cyan-500">
                    Rows:
                </span>
                {{ sketchpad.get_sketchdata_by_name("Rows") | int }}
            </p>
        </div>
    </div>
</div>
<script>
    function testing(text) {
        navigator.clipboard.writeText(text).then(function () {
        }, function (err) {
            console.error('Async: Could not copy text: ', err);
        });
    }
</script>

{%- endmacro %}

{% macro reference_list(portfolio, sketchpadlink=False) -%}

<div class="flex justify-center items-center">
    <ul class="grow">
        {% for sketchpad in portfolio.sketchpads.values() %}
        <li class="p-2">
            {{ reference_card(sketchpad, sketchpadlink) }}
        </li>
        {% endfor %}
    </ul>
</div>

{%- endmacro %}